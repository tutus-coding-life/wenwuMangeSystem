{% extends "base.html" %}
{% block title %}位置管理{% endblock %}
{% block content %}
<h2>位置列表</h2>
{% if current_user.role == 'admin' %}
<a href="{{ url_for('add_location') }}" class="btn btn-success mb-3">添加位置</a>
{% endif %}
<table class="table table-striped">
  <thead>
    <tr>
      <th>ID</th>
      <th>类型</th>
      <th>关联位置</th>
      {% if current_user.role == 'admin' %}
      <th>操作</th>
      {% endif %}
    </tr>
  </thead>
  <tbody>
    {% for item in items %}
    <tr>
      <td>{{ item.id }}</td>
      <td>{{ '库房' if item.type == 'storage' else ('展厅' if item.type == 'exhibition' else item.type) }}</td>
      <td>
        {% if item.type == 'storage' and item.storage_room %}
          {{ item.storage_room.position }}
        {% elif item.type == 'exhibition' and item.exhibition_hall %}
          {{ item.exhibition_hall.position }}
        {% else %}
          —
        {% endif %}
      </td>
      {% if current_user.role == 'admin' %}
      <td>
        <a href="{{ url_for('edit_location', id=item.id) }}" class="btn btn-sm btn-warning">修改</a>
        <form action="{{ url_for('delete_location', id=item.id) }}" method="post" style="display:inline;">
          <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('确定删除？')">删除</button>
        </form>
      </td>
      {% endif %}
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
